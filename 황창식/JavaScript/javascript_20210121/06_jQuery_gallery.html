<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
</head>

<body>
    <h2>Drag To Exit</h2>
    <div id="pivot_slider">
        <div>
            <h1>Lorem ipsum dolor sit amet.</h1>
            <img src="Desert.jpg" width="300px">
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Debitis obcaecati eos modi culpa ad inventore
                amet ducimus illo dolores aut et dolore aspernatur assumenda accusamus odio nam optio perspiciatis
                itaque deleniti, facere delectus quaerat iure? Repudiandae numquam placeat molestiae veniam quasi
                quaerat, odit odio at nulla labore recusandae sunt corporis.</p>
        </div>
        <div>
            <h1>Lorem ipsum dolor sit amet.</h1>
            <img src="Hydrangeas.jpg" width="300px">
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Debitis obcaecati eos modi culpa ad inventore
                amet ducimus illo dolores aut et dolore aspernatur assumenda accusamus odio nam optio perspiciatis
                itaque deleniti, facere delectus quaerat iure? Repudiandae numquam placeat molestiae veniam quasi
                quaerat, odit odio at nulla labore recusandae sunt corporis.</p>
        </div>
        <div>
            <h1>Lorem ipsum dolor sit amet.</h1>
            <img src="Jellyfish.jpg" width="300px">
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Debitis obcaecati eos modi culpa ad inventore
                amet ducimus illo dolores aut et dolore aspernatur assumenda accusamus odio nam optio perspiciatis
                itaque deleniti, facere delectus quaerat iure? Repudiandae numquam placeat molestiae veniam quasi
                quaerat, odit odio at nulla labore recusandae sunt corporis.</p>
        </div>
        <div>
            <h1>Lorem ipsum dolor sit amet.</h1>
            <img src="Koala.jpg" width="300px">
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Debitis obcaecati eos modi culpa ad inventore
                amet ducimus illo dolores aut et dolore aspernatur assumenda accusamus odio nam optio perspiciatis
                itaque deleniti, facere delectus quaerat iure? Repudiandae numquam placeat molestiae veniam quasi
                quaerat, odit odio at nulla labore recusandae sunt corporis.</p>
        </div>
        <div>
            <h1>Lorem ipsum dolor sit amet.</h1>
            <img src="Lighthouse.jpg" width="300px">
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Debitis obcaecati eos modi culpa ad inventore
                amet ducimus illo dolores aut et dolore aspernatur assumenda accusamus odio nam optio perspiciatis
                itaque deleniti, facere delectus quaerat iure? Repudiandae numquam placeat molestiae veniam quasi
                quaerat, odit odio at nulla labore recusandae sunt corporis.</p>
        </div>
    </div>

    <script>
        // pivot 함수 생성
        $.fn.pivot = function (options) {
            //변수 선언
            // 변수 앞에 $ 붙이는 이유
            // jquery를 사용해서 받은 것을 변수에 넣었다는 것을 표시
            var $target = $(this);
            var $items = $target.children();
            var $container = $target.wrap('<div></div>').parent();
            var option = {
                width: 500,
                height: 450
            };

            // 옵션을 변경
            // {width:500, height:450} => {width:700, height:700}
            $.extend(option, options);

            // 스타일 지정
            $target.css({
                width: $items.length * option.width,
                height: option.height,
                position: "absolute"
            });

            $items.css({
                float: 'left',
                width: option.width,
                height: option.height
            });

            $container.css({
                overflow: 'hidden',
                position: 'relative',
                width: option.width,
                height: option.height
            });

            // 이벤트 연결

            var originalLeft = 0;
            var oldLeft = 0;
            var nowPosition = 0;
            var isDown = false;

            $target.on('mousedown', function (event) {
                oldLeft = originalLeft = event.clientX;
                isDown = true;
                event.preventDefault();
            });

            $target.on('mousemove', function (event) {
                if (isDown) {
                    var distance = oldLeft - event.clientX;
                    oldLeft = event.clientX;

                    $target.animate({
                        left: '-=' + distance
                    }, 0);
                    $target.stop(true);
                }
                event.preventDefault();
            });

            $target.on('mouseup', function (event) {
                //움직이는 함수 만듦
                function movePosition(direction) {
                    var changePosition = nowPosition + direction;
                    if (0 <= changePosition && changePosition < $items.length) {
                        nowPosition = changePosition;
                    }
                }

                // 요소의 1/4이상 드래그시 피벗한다
                if (originalLeft - event.clientX > option.width / 4) {
                    movePosition(+1);
                } else if (originalLeft - event.clientX < -option.width / 4) {
                    movePosition(-1);
                }

                $target.animate({
                    'left': -nowPosition * option.width
                }, 'fast');
                isDown = false;
                event.preventDefault();
            })

        }
    </script>

    <script>
        $(document).ready(function () {
            $('#pivot_slider').pivot({
                width: 700,
                height: 700
            })
        });
    </script>
</body>

</html>